<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FitGen AI</title>
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">

<style>
/* ===============================
   GLOBAL STYLES
   =============================== */
body {
  margin: 0;
  background: #060606;
  font-family: Arial, sans-serif;
  color: white;
}

/* ===============================
   NAVBAR
   =============================== */
.topbar {
  height: 60px;
  background: #0b0b0b;
  border-bottom: 1px solid #1f1f1f;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 24px;
}

.main-nav {
  display: flex;
  gap: 18px;
}

.nav-btn {
  background: transparent;
  border: none;
  color: #cfcfcf;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  padding: 8px 14px;
  border-radius: 8px;
  transition: 0.2s ease;
}

.nav-btn:hover {
  background: rgba(255, 0, 0, 0.15);
  color: white;
}

.nav-btn.active {
  background: linear-gradient(135deg, #e10600, #b80000);
  color: white;
  box-shadow: 0 6px 18px rgba(225,6,0,0.4);
}

.user-box {
  display: flex;
  align-items: center;
  gap: 12px;
}


.logo { font-size: 20px; font-weight: 700; }
.logo span { color: red; }

.top-right { display: flex; align-items: center; gap: 12px; }

.avatar {
  background: red;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

/* ===============================
   DROPDOWN
   =============================== */
.dropdown {
  position: absolute;
  top: 60px;
  right: 20px;
  background: #0f0f0f;
  display: none;
  flex-direction: column;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 10px 25px rgba(0,0,0,0.6);
}

.dropdown button {
  padding: 12px 16px;
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  text-align: left;
}

.dropdown button:hover { background: red; }

/* ===============================
   MAIN SECTIONS
   =============================== */
.main { padding: 24px; }

.section { display: none; }
.section.active { display: block; }

/* ===============================
   CARDS
   =============================== */
.cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.card {
  background: linear-gradient(180deg, #121212, #0b0b0b);
  padding: 20px 24px;
  border-radius: 18px;
  border: 1px solid #1f1f1f;
  margin-bottom: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  line-height: 1.7;
  font-size: 14.5px;
}

.card b {
  display: block;
  font-size: 17px;
  margin-bottom: 10px;
  color: #ff2d2d;
}

#workoutContent {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 22px;
}

.card br {
  margin-bottom: 6px;
}


/* ===============================
   FITNESS FORM ‚Äì PRO UI
   =============================== */
.module {
  background: linear-gradient(180deg, #0f0f0f, #090909);
  padding: 28px;
  border-radius: 20px;
  margin-top: 24px;
  border: 1px solid #1f1f1f;
  box-shadow: 0 20px 50px rgba(0,0,0,0.6);
}

.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 18px 22px;
}

.grid input,
.grid select {
  height: 52px;
  padding: 0 16px;
  border-radius: 14px;
  border: 1px solid #1f1f1f;
  background: #141414;
  color: white;
}

/* ===============================
   GENERATE BUTTON
   =============================== */
#fitnessForm button {
  grid-column: span 2;
  width: 320px;
  margin: 20px auto 0 auto;
  height: 56px;
  border-radius: 18px;
  background: linear-gradient(135deg, #e10600, #b80000);
  color: white;
  font-weight: 700;
  cursor: pointer;
  display: block;
}

/* ===============================
   CHATBOT
   =============================== */
#fitgen-chat-btn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  background: #e10600;
  color: white;
  font-size: 26px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 999999;
}

#chat-badge {
  position: absolute;
  top: -6px;
  right: -6px;
  background: #00ff6a;
  color: #000;
  font-size: 10px;
  font-weight: 700;
  padding: 3px 6px;
  border-radius: 999px;
}

#fitgen-chat-box {
  position: fixed;
  bottom: 100px;
  right: 25px;
  width: 340px;
  height: 460px;
  background: #0f0f0f;
  display: none;
  flex-direction: column;
  border-radius: 24px;
  overflow: hidden;
  z-index: 999999;
}

.chat-header {
  background: #121212;
  padding: 14px 18px;
  display: flex;
  justify-content: space-between;
}

.chat-body {
  flex: 1;
  padding: 16px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.chat-footer {
  display: flex;
  gap: 8px;
  padding: 12px;
  background: #0b0b0b;
}

.user-msg {
  align-self: flex-end;
  background: red;
  padding: 10px 16px;
  border-radius: 18px;
}

.bot-msg {
  align-self: flex-start;
  background: #1a1a1a;
  padding: 10px 16px;
  border-radius: 18px;
}

/* ======== WORKOUT CARD HOVER EFFECT ======== */
.card {
  cursor: pointer;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.card:hover {
  transform: translateY(-6px) scale(1.02);
  box-shadow: 0 15px 45px rgba(255, 0, 0, 0.35);
}

/* ======== POP-UP OVERLAY ======== */
.workout-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999999;
}

.workout-overlay.active {
  display: flex;
}

.workout-popup {
  background: linear-gradient(180deg, #121212, #0a0a0a);
  width: 92%;
  max-width: 520px;
  max-height: 85vh;
  overflow-y: auto;
  padding: 28px 30px;
  border-radius: 22px;
  border: 1px solid #2a2a2a;
  box-shadow: 0 25px 60px rgba(0,0,0,0.8);
  animation: popupZoom 0.25s ease;
}

@keyframes popupZoom {
  from { transform: scale(0.85); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}

.popup-close {
  float: right;
  font-size: 18px;
  color: #ff3b3b;
  cursor: pointer;
  font-weight: bold;
}

/* ========== NUTRITION PROGRESS BARS ========== */
.nutrition-container {
  background: #0f0f0f;
  padding: 20px;
  border-radius: 16px;
  margin-top: 20px;
  border: 1px solid #1f1f1f;
}

.nutri-item {
  margin-bottom: 16px;
}

.nutri-item span {
  display: block;
  font-weight: 600;
  margin-bottom: 6px;
}

.bar {
  background: #222;
  border-radius: 12px;
  height: 14px;
  overflow: hidden;
}

.fill {
  height: 100%;
  width: 0;
  border-radius: 12px;
  transition: width 0.6s ease;
}

#calBar { background: linear-gradient(90deg, #ffcc00, #ff9900); }
#proteinBar { background: linear-gradient(90deg, #00ffcc, #00bfa5); }
#carbBar { background: linear-gradient(90deg, #4da6ff, #0066cc); }
#fatBar { background: linear-gradient(90deg, #ff4d4d, #b30000); }

.nutri-item small {
  display: block;
  margin-top: 4px;
  color: #ccc;
}
/* ===============================
   CHAT INPUT & SEND BUTTON FIX
   =============================== */

.chat-footer input {
  flex: 1;
  height: 40px;
  padding: 0 14px;
  border-radius: 12px;
  border: 1px solid #222;
  background: #141414;
  color: #fff;
  outline: none;
  font-size: 14px;
}

.chat-footer button {
  height: 40px;
  padding: 0 18px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(135deg, #e10600, #b80000);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}

.chat-footer button:hover {
  opacity: 0.9;
}

/* ‚úÖ Chat bubble spacing fix */
.bot-msg, .user-msg {
  max-width: 80%;
  word-wrap: break-word;
}

/* ‚úÖ Chat box rounded smooth look */
#fitgen-chat-box {
  border-radius: 24px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.85);
}

/* ‚úÖ Remove ugly default white input look */
#chat-input {
  background: #141414 !important;
  color: white !important;
  border: 1px solid #1f1f1f !important;
}


</style>
</head>

<body>

<header class="topbar">
  <div class="logo">FITGEN <span>AI</span></div>

  <nav class="main-nav">
    <button class="nav-btn active" data-section="dashboard">Dashboard</button>
    <button class="nav-btn" data-section="workouts">Workouts</button>
    <button class="nav-btn" data-section="diet">Diet</button>
    <button class="nav-btn" data-section="profile">Profile</button>
  </nav>

  <div class="user-box">
    <span id="userNameDisplay">Guest</span>
    <div class="avatar">RP</div>
  </div>
</header>

<main class="main">

<section id="dashboard" class="section active">
  <h2>Dashboard</h2>

  <div class="cards">
    <div class="card">BMI: <span id="bmiCard">--</span></div>
    <div class="card">Daily Intake Calories: <span id="calCard">--</span></div>
    <div class="card">Goal: <span id="goalCard">--</span></div>
  </div>

  <div class="module">
    <h3>Create Fitness Plan</h3>
    <form id="fitnessForm">
      <div class="grid">
        <input id="name" placeholder="Name" required>
        <input id="age" type="number" placeholder="Age" required>
        <input id="height" type="number" placeholder="Height (cm)" required>
        <input id="weight" type="number" placeholder="Weight (kg)" required>

        <select id="gender">
          <option>Male</option>
          <option>Female</option>
        </select>

        <select id="goal">
          <option>Fat Loss</option>
          <option>Muscle Gain</option>
          <option>Maintenance</option>
        </select>

        <select id="dietType">
          <option>Vegetarian</option>
          <option>Non-Vegetarian</option>
        </select>

        <select id="time">
          <option>30 Minutes</option>
          <option>45 Minutes</option>
          <option>60 Minutes</option>
        </select>
      </div>
      <button type="submit">Generate</button>
    </form>
  </div>
</section>

<section id="workouts" class="section">
  <h2>Workout Plans</h2>
  <div id="workoutContent"></div>
</section>

<section id="diet" class="section">
  <h2>Diet Planner</h2>
  <!-- ‚úÖ Nutrition Progress Bars -->
  <div id="nutritionBars" class="nutrition-container">

    <div class="nutri-item">
      <span>Calories</span>
      <div class="bar">
        <div class="fill" id="calBar"></div>
      </div>
      <small id="calText">0 kcal</small>
    </div>

    <div class="nutri-item">
      <span>Protein</span>
      <div class="bar">
        <div class="fill" id="proteinBar"></div>
      </div>
      <small id="proteinText">0 g</small>
    </div>

    <div class="nutri-item">
      <span>Carbs</span>
      <div class="bar">
        <div class="fill" id="carbBar"></div>
      </div>
      <small id="carbText">0 g</small>
    </div>

    <div class="nutri-item">
      <span>Fat</span>
      <div class="bar">
        <div class="fill" id="fatBar"></div>
      </div>
      <small id="fatText">0 g</small>
    </div>
  </div>

  <!-- Optional extra diet details -->
  <div id="dietContent"></div>
</section>

<section id="progress" class="section"><h2>Progress</h2></section>
<section id="profile" class="section">
  <h2>Profile</h2>

  <div class="module">
    <h3>User Information</h3>

    <div class="grid">
      <input id="profileName" placeholder="Full Name">
      <input id="profileAge" type="number" placeholder="Age">

      <input id="profileHeight" type="number" placeholder="Height (cm)">
      <input id="profileWeight" type="number" placeholder="Weight (kg)">

      <select id="profileGender">
        <option>Male</option>
        <option>Female</option>
      </select>

      <select id="profileGoal">
        <option>Fat Loss</option>
        <option>Muscle Gain</option>
        <option>Maintenance</option>
      </select>

      <select id="profileDiet">
        <option>Vegetarian</option>
        <option>Non-Vegetarian</option>
      </select>

      <select id="profileTime">
        <option>30 Minutes</option>
        <option>45 Minutes</option>
        <option>60 Minutes</option>
      </select>
    </div>

    <button id="saveProfileBtn">Save Profile</button>

    <p id="profileStatus" style="margin-top:12px;color:#00ff6a;"></p>
  </div>
</section>


</main>

<!-- CHATBOT -->
<div id="fitgen-chat-btn">üí¨ <span id="chat-badge">NEW</span></div>

<div id="fitgen-chat-box">
  <div class="chat-header">
    FitGen AI <span id="chat-close">‚úñ</span>
  </div>
  <div class="chat-body" id="chat-body"></div>
  <div class="chat-footer">
    <input id="chat-input" placeholder="Ask fitness question...">
    <button id="chat-send">Send</button>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ===============================
     NAV BUTTON SECTION SWITCH
     =============================== */
  document.querySelectorAll(".nav-btn").forEach((btn) => {
    btn.onclick = () => {

      document.querySelectorAll(".nav-btn").forEach(b =>
        b.classList.remove("active")
      );

      btn.classList.add("active");

      document.querySelectorAll(".section").forEach(sec =>
        sec.classList.remove("active")
      );

      document.getElementById(btn.dataset.section)
        .classList.add("active");
    };

  });


  /* ===============================
     CHATBOT LOGIC
     =============================== */
  const chatBtn   = document.getElementById("fitgen-chat-btn");
  const chatBox   = document.getElementById("fitgen-chat-box");
  const chatClose = document.getElementById("chat-close");
  const chatSend  = document.getElementById("chat-send");
  const chatInput = document.getElementById("chat-input");
  const chatBody  = document.getElementById("chat-body");
  const chatBadge = document.getElementById("chat-badge");

  let greeted = false;

  chatBtn.onclick = () => {
    const isOpen = chatBox.style.display === "flex";
    chatBox.style.display = isOpen ? "none" : "flex";

    if (!isOpen && chatBadge) chatBadge.style.display = "none";

    if (!isOpen && !greeted) {
      chatBody.innerHTML += `
        <div class="bot-msg">
          üëã Hi! I'm <b>FitGen AI</b>, your personal fitness coach.<br><br>
          ‚úÖ Weight loss<br>
          ‚úÖ Muscle gain<br>
          ‚úÖ Diet planning<br>
          ‚úÖ Home & gym workouts<br><br>
          How can I help you today?
        </div>
      `;
      greeted = true;
      chatBody.scrollTop = chatBody.scrollHeight;
    }
  };

  chatClose.onclick = () => {
    chatBox.style.display = "none";
  };

  chatSend.onclick = sendMessage;
  chatInput.onkeypress = (e) => {
    if (e.key === "Enter") sendMessage();
  };

  async function sendMessage() {
    const msg = chatInput.value.trim();
    if (!msg) return;

    chatBody.innerHTML += `<div class="user-msg">${msg}</div>`;
    chatInput.value = "";

    const typingDiv = document.createElement("div");
    typingDiv.className = "bot-msg";
    typingDiv.innerText = "Typing...";
    chatBody.appendChild(typingDiv);
    chatBody.scrollTop = chatBody.scrollHeight;

    try {
      const res = await fetch(
        "https://ramdtproject.app.n8n.cloud/webhook/Chatbot",
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: msg }),
        }
      );

      const data = await res.json();
      typingDiv.innerText =
        data.output || data.reply || data.message || "No reply received";

    } catch {
      typingDiv.innerText = "‚ö†Ô∏è Server error. Please try again.";
    }
  }


  /* ===============================
     FITNESS AI INTEGRATION (REAL n8n)
     =============================== */
  const fitnessForm    = document.getElementById("fitnessForm");
  const workoutContent = document.getElementById("workoutContent");
  const dietContent    = document.getElementById("dietContent");
  const generateBtn    = fitnessForm.querySelector("button");

  function calculateNutrition({ age, height, weight, gender, goal, time }) {

    const bmi = (weight / ((height / 100) ** 2)).toFixed(2);

    let bmr;
    if (gender === "Male") {
      bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
    } else {
      bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
    }

    let multiplier = 1.375;
    if (time.includes("45")) multiplier = 1.55;
    if (time.includes("60")) multiplier = 1.725;

    let tdee = bmr * multiplier;

    if (goal === "Fat Loss") tdee -= 500;
    if (goal === "Muscle Gain") tdee += 300;

    const dailyCalories = Math.round(tdee);
    const protein = Math.round(weight * 2);
    const fat = Math.round(weight * 0.9);
    const carbs = Math.round(
      (dailyCalories - (protein * 4 + fat * 9)) / 4
    );

    return { bmi, dailyCalories, protein, carbs, fat };
  }


  fitnessForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    generateBtn.innerText = "Generating...";
    generateBtn.disabled = true;

    const userData = {
      name: name.value,
      age: age.value,
      height: height.value,
      weight: weight.value,
      gender: gender.value,
      goal: goal.value,
      diet: dietType.value,
      time: time.value,
    };

    const nutrition = calculateNutrition({
      age: +age.value,
      height: +height.value,
      weight: +weight.value,
      gender: gender.value,
      goal: goal.value,
      time: time.value
    });

    document.getElementById("bmiCard").innerText = nutrition.bmi;
    document.getElementById("calCard").innerText = nutrition.dailyCalories;
    document.getElementById("goalCard").innerText = goal.value;

    const MAX_CAL = 4000, MAX_PROTEIN = 250, MAX_CARBS = 500, MAX_FAT = 150;

    document.getElementById("calBar").style.width = (nutrition.dailyCalories / MAX_CAL) * 100 + "%";
    document.getElementById("proteinBar").style.width = (nutrition.protein / MAX_PROTEIN) * 100 + "%";
    document.getElementById("carbBar").style.width = (nutrition.carbs / MAX_CARBS) * 100 + "%";
    document.getElementById("fatBar").style.width = (nutrition.fat / MAX_FAT) * 100 + "%";

    document.getElementById("calText").innerText = nutrition.dailyCalories + " kcal/day";
    document.getElementById("proteinText").innerText = nutrition.protein + " g/day";
    document.getElementById("carbText").innerText = nutrition.carbs + " g/day";
    document.getElementById("fatText").innerText = nutrition.fat + " g/day";

    workoutContent.innerHTML = "‚è≥ Generating workout with AI...";
    dietContent.innerHTML = "‚è≥ Generating diet with AI...";

    try {
      const res = await fetch(
        "https://ramdtproject.app.n8n.cloud/webhook/fitgen-ai",
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(userData),
        }
      );

      const raw = await res.json();
      let data = typeof raw.output === "string"
        ? JSON.parse(raw.output.replace("```json", "").replace("```", "").trim())
        : raw;

      workoutContent.innerHTML = "";
      if (data.workout_plan) {
        for (let day in data.workout_plan) {
          workoutContent.innerHTML += `
            <div class="card">
              <b>${day}</b><br>
              ${data.workout_plan[day].map(ex => "‚Ä¢ " + ex).join("<br>")}
            </div>`;
        }
      }

      dietContent.innerHTML = "";
      if (data.diet_plan) {
        for (let meal in data.diet_plan) {
          dietContent.innerHTML += `
            <div class="card">
              <b>${meal}</b><br>
              ${data.diet_plan[meal].join("<br>")}
            </div>`;
        }
      }

      document.querySelector('[data-section="diet"]').click();

    } catch (err) {
      workoutContent.innerHTML = "‚ùå Failed to load workout";
      dietContent.innerHTML = "‚ùå Failed to load diet";
      console.error(err);
    }

    generateBtn.innerText = "Generate";
    generateBtn.disabled = false;
  });


  /* ===============================
     ‚úÖ WORKOUT POPUP INTERACTION (SAFE FIX)
     =============================== */
  const overlay   = document.getElementById("workoutOverlay");
  const popupText = document.getElementById("popupContent");
  const popupClose = document.getElementById("popupClose");

  document.addEventListener("click", (e) => {
    const card = e.target.closest(".card");
    if (!card || !overlay) return;

    popupText.innerHTML = card.innerHTML;
    overlay.classList.add("active");
  });

  popupClose.onclick = () => overlay.classList.remove("active");

  overlay.onclick = (e) => {
    if (e.target === overlay) overlay.classList.remove("active");
  };

});

</script>





<div class="workout-overlay" id="workoutOverlay">
  <div class="workout-popup" id="workoutPopup">
    <span class="popup-close" id="popupClose">‚úñ</span>
    <div id="popupContent"></div>
  </div>
</div>

</body>
</html>
